@(myForm: Form[Dataset], filesList: List[(String, String)])(implicit flash: play.api.mvc.Flash, user: Option[securesocial.core.Identity])

@import helper._
@implicitFieldConstructor = @{ FieldConstructor(twitterBootstrapInput.f) }

@main("Dataset") {
  <script>
  	function clearUpload(){
  		$('#file').val('');
  	}
  </script>  
  <div class="page-header">
    <h1>Create New Dataset</h1>
  </div>
  <div class="row">
	<div class="col-md-12">
	@if(myForm.hasErrors) {
		<div class="alert alert-error">
            <p>Please fix all errors</p>
        </div>
    }
    @flash.get("error").map { message =>
    	<div class="alert alert-error">
            <p>@message</p>
        </div>
    }
    
	  @form(action = routes.Datasets.submit(), 'enctype -> "multipart/form-data", 'class -> "form-horizontal") {	 
	    <fieldset>
	      @inputText(myForm("name"), '_label -> "Name")
	      @textarea(myForm("description"), '_label -> "Description")
	    </fieldset>
	    <fieldset>
	      @inputFile(myForm("file"), '_label -> "Upload file")
	    </fieldset>
	    <button id="uploadCLearBtn" style="position: relative; left:180px; top: -17px;" onclick="clearUpload();return false;">Clear</button>
	    <fieldset>
	      @select(
  			myForm("existingFile"),
  			("__nofile" -> "--NONE--") +: filesList.map{ oneFile =>
    			oneFile._1 -> (oneFile._2)
  			},
  			'_label -> "or select an existing file"
		)
	    </fieldset>
	    <fieldset id="datasetRadioFieldSet">
	      @inputRadioGroup(
	          myForm("datasetLevel").copy(value=myForm("datasetLevel").value.orElse(Some("DatasetLevel")) ),
	          options = options("DatasetLevel"->"Everywhere","FileLevel"->"On file page","None"->"Nowhere"),
	          '_label -> "Show file preview(s)",
	          '_error -> myForm("datasetLevel").error.map(_.withMessage("Select where the preview will be viewable.")))
	    </fieldset>
        <div class="form-actions">
          <input type="submit" class="btn btn-default" value="Upload"/>
        </div>
	  }
    </div>
  </div>
}
